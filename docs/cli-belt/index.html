<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>cli-belt - v2.0.2</title><meta name="description" content="Documentation for cli-belt"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">cli-belt - v2.0.2</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>cli-belt - v2.0.2</h2></div><div class="tsd-panel tsd-typography"><a id="md:cli-belt" class="tsd-anchor"></a><h1 class="tsd-anchor-link">cli-belt<a href="#md:cli-belt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://www.npmjs.com/package/cli-belt"><img src="https://img.shields.io/npm/v/cli-belt.svg" alt="Version"></a>
<a href="https://www.npmjs.com/package/cli-belt"><img src="https://img.shields.io/npm/types/cli-belt.svg" alt="Types"></a>
<a href="https://github.com/rafamel/utils/blob/master/LICENSE"><img src="https://img.shields.io/github/license/rafamel/utils.svg" alt="License"></a></p>
<blockquote>
<p>A lossless slug that preserves uniqueness.</p>
</blockquote>
<a id="md:install" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Install<a href="#md:install" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="https://www.npmjs.com/package/cli-belt"><code>npm install cli-belt</code></a></p>
<a id="md:motivation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Motivation<a href="#md:motivation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Most solutions for creating command line interfaces have a too high degree of magic going on that prevents proper control over how arguments are parsed, which arguments are parsed, and so on. On the other hand, using barebones argument parsers can require much boilerplate. <code>cli-belt</code> intends to complement the later, reducing the amount of boilerplate needed. I've found <a href="https://github.com/zeit/arg"><code>arg</code></a> to be a blissful middle ground for argument parsing, but which parser you use is entirely up to you.</p>
<a id="md:documentation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Documentation<a href="#md:documentation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>These are all of <code>cli-belt</code>'s helper functions -<a href="https://rafamel.github.io/utils/cli-belt/">see docs:</a></p>
<ul>
<li><a href="https://rafamel.github.io/utils/cli-belt/functions/loadPackage.html"><code>loadPackage</code></a> finds and returns the contents of the first <code>package.json</code> found, recursing up from a <code>dir</code>.</li>
<li><a href="https://rafamel.github.io/utils/cli-belt/functions/flags.html"><code>flags</code></a> parses a <code>help</code> string and returns an object with options, aliases, arguments, and descriptions.</li>
<li><a href="https://rafamel.github.io/utils/cli-belt/functions/safePairs.html"><code>safePairs</code></a> ensures all properties of an object exist in another.</li>
<li><a href="https://rafamel.github.io/utils/cli-belt/functions/splitBy.html"><code>splitBy</code></a> splits an arguments array into two arrays by the first <code>separator</code>.</li>
<li><a href="https://rafamel.github.io/utils/cli-belt/functions/error.html"><code>error</code></a> formats and prints an error message, optionally exiting the process.</li>
</ul>
<a id="md:usage-example" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage example<a href="#md:usage-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="javascript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">error</span><span class="hl-1">, </span><span class="hl-2">flags</span><span class="hl-1">, </span><span class="hl-2">loadPackage</span><span class="hl-1">, </span><span class="hl-2">safePairs</span><span class="hl-1">, </span><span class="hl-2">splitBy</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;cli-belt&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">stripIndent</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-2">indent</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;common-tags&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">arg</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;arg&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">logger</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;loglevel&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">spawn</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;await-spawn&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">main</span><span class="hl-1">().</span><span class="hl-4">catch</span><span class="hl-1">((</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">error</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">, { </span><span class="hl-2">exit:</span><span class="hl-1"> </span><span class="hl-6">1</span><span class="hl-1">, </span><span class="hl-2">debug:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1">, </span><span class="hl-2">logger</span><span class="hl-1"> }));</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-4">main</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-7">// Get description and version from `package.json`</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">pkg</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-4">loadPackage</span><span class="hl-1">(</span><span class="hl-2">__dirname</span><span class="hl-1">, { </span><span class="hl-2">title:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1"> });</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">help</span><span class="hl-1"> = </span><span class="hl-4">indent</span><span class="hl-3">`</span><br/><span class="hl-3">    </span><span class="hl-5">${</span><span class="hl-2">pkg</span><span class="hl-9">.</span><span class="hl-2">description</span><span class="hl-9"> </span><span class="hl-1">||</span><span class="hl-9"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-5">}</span><br/><br/><span class="hl-3">    Usage: example [options] -- [echoArgs]</span><br/><br/><span class="hl-3">    Options:</span><br/><span class="hl-3">      -e, --env &lt;environment&gt;    Node environment</span><br/><span class="hl-3">      -h, --help                 Show help</span><br/><span class="hl-3">      -v, --version              Show version number</span><br/><br/><span class="hl-3">    Examples:</span><br/><span class="hl-3">      $ example -v</span><br/><span class="hl-3">      $ example --help</span><br/><span class="hl-3">      $ example -- &quot;this will get printed because we&#39;re spawning echo&quot;</span><br/><span class="hl-3">  `</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Get flags and aliases from help</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-8">options</span><span class="hl-1">, </span><span class="hl-8">aliases</span><span class="hl-1"> } = </span><span class="hl-4">flags</span><span class="hl-1">(</span><span class="hl-2">help</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Define option types</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">types</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;--env&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;--help&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">Boolean</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;--version&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">Boolean</span><br/><span class="hl-1">  };</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Ensure all parsed flags have a defined type,</span><br/><span class="hl-1">  </span><span class="hl-7">// and that they have all been successfully parsed and exist on help</span><br/><span class="hl-1">  </span><span class="hl-4">safePairs</span><span class="hl-1">(</span><span class="hl-2">types</span><span class="hl-1">, </span><span class="hl-2">options</span><span class="hl-1">, { </span><span class="hl-2">fail:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1">, </span><span class="hl-2">bidirectional:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1"> });</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Add aliases to the ones explicitly typed</span><br/><span class="hl-1">  </span><span class="hl-2">Object</span><span class="hl-1">.</span><span class="hl-4">assign</span><span class="hl-1">(</span><span class="hl-2">types</span><span class="hl-1">, </span><span class="hl-2">aliases</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Only pass to `arg` arguments before &#39;--&#39;</span><br/><span class="hl-1">  </span><span class="hl-7">// arguments after &#39;--&#39; will be passed to spawn</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> [</span><span class="hl-8">argv</span><span class="hl-1">, </span><span class="hl-8">args</span><span class="hl-1">] = </span><span class="hl-4">splitBy</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-4">slice</span><span class="hl-1">(</span><span class="hl-6">2</span><span class="hl-1">), </span><span class="hl-3">&#39;--&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">cmd</span><span class="hl-1"> = </span><span class="hl-4">arg</span><span class="hl-1">(</span><span class="hl-2">types</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">argv</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">permissive:</span><span class="hl-1"> </span><span class="hl-5">false</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">stopAtPositional:</span><span class="hl-1"> </span><span class="hl-5">true</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// Handle options</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">cmd</span><span class="hl-1">.</span><span class="hl-2">_</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1">) </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">Error</span><span class="hl-1">(</span><span class="hl-3">`Unknown command </span><span class="hl-5">${</span><span class="hl-2">cmd</span><span class="hl-9">.</span><span class="hl-2">_</span><span class="hl-9">[</span><span class="hl-6">0</span><span class="hl-9">]</span><span class="hl-5">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">cmd</span><span class="hl-1">[</span><span class="hl-3">&#39;--help&#39;</span><span class="hl-1">]) </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">help</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">cmd</span><span class="hl-1">[</span><span class="hl-3">&#39;--version&#39;</span><span class="hl-1">]) </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">pkg</span><span class="hl-1">.</span><span class="hl-2">version</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">env</span><span class="hl-1"> = </span><span class="hl-2">cmd</span><span class="hl-1">[</span><span class="hl-3">&#39;--env&#39;</span><span class="hl-1">] ? { </span><span class="hl-2">NODE_ENV:</span><span class="hl-1"> </span><span class="hl-2">cmd</span><span class="hl-1">[</span><span class="hl-3">&#39;--env&#39;</span><span class="hl-1">] } : {};</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-4">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;echo&#39;</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">, { </span><span class="hl-2">env</span><span class="hl-1">, </span><span class="hl-2">stdio:</span><span class="hl-1"> </span><span class="hl-3">&#39;inherit&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:cli-belt"><span>cli-<wbr/>belt</span></a><ul><li><a href="#md:install"><span>Install</span></a></li><li><a href="#md:motivation"><span>Motivation</span></a></li><li><a href="#md:documentation"><span>Documentation</span></a></li><li><a href="#md:usage-example"><span>Usage example</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>cli-belt - v2.0.2</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
